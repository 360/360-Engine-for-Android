<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.6.0_20) on Wed Jun 09 00:20:42 CEST 2010 -->
<TITLE>
HeartbeatSenderThread (Vodafone 360 People - API Specification)
</TITLE>

<META NAME="date" CONTENT="2010-06-09">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="HeartbeatSenderThread (Vodafone 360 People - API Specification)";
    }
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">
<HR>


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>

				<img
				src=../../../../../../resources/logo.png 
				width=88 height=40 border=0
				>
			</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../../../com/vodafone360/people/service/transport/tcp/ConnectionTester.html" title="class in com.vodafone360.people.service.transport.tcp"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../../../com/vodafone360/people/service/transport/tcp/ResponseReaderThread.html" title="class in com.vodafone360.people.service.transport.tcp"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../../../index.html?com/vodafone360/people/service/transport/tcp/HeartbeatSenderThread.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="HeartbeatSenderThread.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
com.vodafone360.people.service.transport.tcp</FONT>
<BR>
Class HeartbeatSenderThread</H2>
<PRE>
java.lang.Object
  <IMG SRC="../../../../../../resources/inherit.gif" ALT="extended by "><B>com.vodafone360.people.service.transport.tcp.HeartbeatSenderThread</B>
</PRE>
<DL>
<DT><B>All Implemented Interfaces:</B> <DD><A HREF="../../../../../../com/vodafone360/people/service/transport/IWakeupListener.html" title="interface in com.vodafone360.people.service.transport">IWakeupListener</A>, java.lang.Runnable</DD>
</DL>
<HR>
<DL>
<DT><PRE>public class <B>HeartbeatSenderThread</B><DT>extends java.lang.Object<DT>implements java.lang.Runnable, <A HREF="../../../../../../com/vodafone360/people/service/transport/IWakeupListener.html" title="interface in com.vodafone360.people.service.transport">IWakeupListener</A></DL>
</PRE>

<P>
Sends heartbeats to the RPG in order to keep the connection alive.
<P>

<P>
<DL>
<DT><B>Author:</B></DT>
  <DD>Rudy Norff (rudy.norff@vodafone.com)</DD>
</DL>
<HR>

<P>
<!-- =========== FIELD SUMMARY =========== -->

<A NAME="field_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Field Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;<A HREF="../../../../../../com/vodafone360/people/service/transport/tcp/TcpConnectionThread.html" title="class in com.vodafone360.people.service.transport.tcp">TcpConnectionThread</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/vodafone360/people/service/transport/tcp/HeartbeatSenderThread.html#mConnThread">mConnThread</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The managing thread that needs to be called back if an IOException occurs
 sending a heartbeat.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected static&nbsp;<A HREF="../../../../../../com/vodafone360/people/service/transport/tcp/HeartbeatSenderThread.html" title="class in com.vodafone360.people.service.transport.tcp">HeartbeatSenderThread</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/vodafone360/people/service/transport/tcp/HeartbeatSenderThread.html#mCurrentThread">mCurrentThread</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The HeartbeatSenderThread that was created by the TcpConnectionThread.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;long</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/vodafone360/people/service/transport/tcp/HeartbeatSenderThread.html#mHeartbeatInterval">mHeartbeatInterval</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This is the interval at which the heartbeat gets sent.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private static&nbsp;long</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/vodafone360/people/service/transport/tcp/HeartbeatSenderThread.html#MILLIS_PER_SEC">MILLIS_PER_SEC</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The milliseconds in a second.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/vodafone360/people/service/transport/tcp/HeartbeatSenderThread.html#mIsConnectionRunning">mIsConnectionRunning</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Indicates that the connection is running if true.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;java.io.OutputStream</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/vodafone360/people/service/transport/tcp/HeartbeatSenderThread.html#mOs">mOs</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The output stream to write the heartbeat to.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;<A HREF="../../../../../../com/vodafone360/people/service/RemoteService.html" title="class in com.vodafone360.people.service">RemoteService</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/vodafone360/people/service/transport/tcp/HeartbeatSenderThread.html#mService">mService</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The service under which context the hb sender runs in.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;java.net.Socket</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/vodafone360/people/service/transport/tcp/HeartbeatSenderThread.html#mSocket">mSocket</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The socket to write to.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;java.lang.Thread</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/vodafone360/people/service/transport/tcp/HeartbeatSenderThread.html#mThread">mThread</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The thread continuously sending the heartbeats.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;PowerManager.WakeLock</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/vodafone360/people/service/transport/tcp/HeartbeatSenderThread.html#mWakeLock">mWakeLock</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Keeps a partial wake lock on the CPU that will prevent it from sleeping
 and allow the Sender to send off heartbeats.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="fields_inherited_from_class_com.vodafone360.people.service.transport.IWakeupListener"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Fields inherited from interface com.vodafone360.people.service.transport.<A HREF="../../../../../../com/vodafone360/people/service/transport/IWakeupListener.html" title="interface in com.vodafone360.people.service.transport">IWakeupListener</A></B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><A HREF="../../../../../../com/vodafone360/people/service/transport/IWakeupListener.html#ALARM_HB_THREAD">ALARM_HB_THREAD</A></CODE></TD>
</TR>
</TABLE>
&nbsp;
<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../../../com/vodafone360/people/service/transport/tcp/HeartbeatSenderThread.html#HeartbeatSenderThread(com.vodafone360.people.service.transport.tcp.TcpConnectionThread, com.vodafone360.people.service.RemoteService, java.net.Socket)">HeartbeatSenderThread</A></B>(<A HREF="../../../../../../com/vodafone360/people/service/transport/tcp/TcpConnectionThread.html" title="class in com.vodafone360.people.service.transport.tcp">TcpConnectionThread</A>&nbsp;connThread,
                      <A HREF="../../../../../../com/vodafone360/people/service/RemoteService.html" title="class in com.vodafone360.people.service">RemoteService</A>&nbsp;service,
                      java.net.Socket&nbsp;socket)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Constructs a heartbeat-sender and passes the connection thread to call
 back to in case of errors.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/vodafone360/people/service/transport/tcp/HeartbeatSenderThread.html#getHeartbeatHessianPayload()">getHeartbeatHessianPayload</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns a byte-array containing the data needed for sending a heartbeat
 to the RPG.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/vodafone360/people/service/transport/tcp/HeartbeatSenderThread.html#getIsActive()">getIsActive</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 Returns true if the heartbeat thread is currently running/active.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/vodafone360/people/service/transport/tcp/HeartbeatSenderThread.html#notifyOfWakeupAlarm()">notifyOfWakeupAlarm</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Called whenever the Service receives a Wakeup Alarm intent.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/vodafone360/people/service/transport/tcp/HeartbeatSenderThread.html#run()">run</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The run-method overriding Thread.run().</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/vodafone360/people/service/transport/tcp/HeartbeatSenderThread.html#sendHeartbeat()">sendHeartbeat</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Prepares the necessary Hessian payload and writes it directly to the open
 output-stream of the socket.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/vodafone360/people/service/transport/tcp/HeartbeatSenderThread.html#setOutputStream(java.io.OutputStream)">setOutputStream</A></B>(java.io.OutputStream&nbsp;outputStream)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets the output-stream so that the heartbeat-sender can send its
 heartbeats to the RPG.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/vodafone360/people/service/transport/tcp/HeartbeatSenderThread.html#startConnection()">startConnection</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets the state of the connection to run and spawns a thread to run it in.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../com/vodafone360/people/service/transport/tcp/HeartbeatSenderThread.html#stopConnection()">stopConnection</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Stops the heartbeat-senders connection and closes the output-stream to
 the socket-connection.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.Object</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ FIELD DETAIL =========== -->

<A NAME="field_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Field Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="mCurrentThread"><!-- --></A><H3>
mCurrentThread</H3>
<PRE>
protected static <A HREF="../../../../../../com/vodafone360/people/service/transport/tcp/HeartbeatSenderThread.html" title="class in com.vodafone360.people.service.transport.tcp">HeartbeatSenderThread</A> <B>mCurrentThread</B></PRE>
<DL>
<DD>The HeartbeatSenderThread that was created by the TcpConnectionThread. It
 will be compared to this thread. If they differ this thread must be a
 lock thread that got stuck when the user changed APNs or switched from
 WiFi to another data connection type.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="MILLIS_PER_SEC"><!-- --></A><H3>
MILLIS_PER_SEC</H3>
<PRE>
private static final long <B>MILLIS_PER_SEC</B></PRE>
<DL>
<DD>The milliseconds in a second.
<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../../../../../constant-values.html#com.vodafone360.people.service.transport.tcp.HeartbeatSenderThread.MILLIS_PER_SEC">Constant Field Values</A></DL>
</DL>
<HR>

<A NAME="mService"><!-- --></A><H3>
mService</H3>
<PRE>
private <A HREF="../../../../../../com/vodafone360/people/service/RemoteService.html" title="class in com.vodafone360.people.service">RemoteService</A> <B>mService</B></PRE>
<DL>
<DD>The service under which context the hb sender runs in. Used for setting
 alarms that wake up the CPU for sending out heartbeats.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="mConnThread"><!-- --></A><H3>
mConnThread</H3>
<PRE>
private <A HREF="../../../../../../com/vodafone360/people/service/transport/tcp/TcpConnectionThread.html" title="class in com.vodafone360.people.service.transport.tcp">TcpConnectionThread</A> <B>mConnThread</B></PRE>
<DL>
<DD>The managing thread that needs to be called back if an IOException occurs
 sending a heartbeat.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="mThread"><!-- --></A><H3>
mThread</H3>
<PRE>
protected java.lang.Thread <B>mThread</B></PRE>
<DL>
<DD>The thread continuously sending the heartbeats.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="mOs"><!-- --></A><H3>
mOs</H3>
<PRE>
protected java.io.OutputStream <B>mOs</B></PRE>
<DL>
<DD>The output stream to write the heartbeat to.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="mHeartbeatInterval"><!-- --></A><H3>
mHeartbeatInterval</H3>
<PRE>
protected long <B>mHeartbeatInterval</B></PRE>
<DL>
<DD>This is the interval at which the heartbeat gets sent. The problem with
 this is that this timeout interval is only proven in the Vodafone
 network. In other networks we will do an autodetect for the correct
 interval settings.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="mIsConnectionRunning"><!-- --></A><H3>
mIsConnectionRunning</H3>
<PRE>
private boolean <B>mIsConnectionRunning</B></PRE>
<DL>
<DD>Indicates that the connection is running if true.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="mWakeLock"><!-- --></A><H3>
mWakeLock</H3>
<PRE>
private PowerManager.WakeLock <B>mWakeLock</B></PRE>
<DL>
<DD>Keeps a partial wake lock on the CPU that will prevent it from sleeping
 and allow the Sender to send off heartbeats.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="mSocket"><!-- --></A><H3>
mSocket</H3>
<PRE>
private java.net.Socket <B>mSocket</B></PRE>
<DL>
<DD>The socket to write to.
<P>
<DL>
</DL>
</DL>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="HeartbeatSenderThread(com.vodafone360.people.service.transport.tcp.TcpConnectionThread, com.vodafone360.people.service.RemoteService, java.net.Socket)"><!-- --></A><H3>
HeartbeatSenderThread</H3>
<PRE>
public <B>HeartbeatSenderThread</B>(<A HREF="../../../../../../com/vodafone360/people/service/transport/tcp/TcpConnectionThread.html" title="class in com.vodafone360.people.service.transport.tcp">TcpConnectionThread</A>&nbsp;connThread,
                             <A HREF="../../../../../../com/vodafone360/people/service/RemoteService.html" title="class in com.vodafone360.people.service">RemoteService</A>&nbsp;service,
                             java.net.Socket&nbsp;socket)</PRE>
<DL>
<DD>Constructs a heartbeat-sender and passes the connection thread to call
 back to in case of errors.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>connThread</CODE> - The connection thread to call back to in case of
            networking issues.<DD><CODE>service</CODE> - The remote service that we register with once we have set
            the heartbeat alarm.</DL>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="startConnection()"><!-- --></A><H3>
startConnection</H3>
<PRE>
public void <B>startConnection</B>()</PRE>
<DL>
<DD>Sets the state of the connection to run and spawns a thread to run it in.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="stopConnection()"><!-- --></A><H3>
stopConnection</H3>
<PRE>
public void <B>stopConnection</B>()</PRE>
<DL>
<DD>Stops the heartbeat-senders connection and closes the output-stream to
 the socket-connection.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="setOutputStream(java.io.OutputStream)"><!-- --></A><H3>
setOutputStream</H3>
<PRE>
public void <B>setOutputStream</B>(java.io.OutputStream&nbsp;outputStream)</PRE>
<DL>
<DD>Sets the output-stream so that the heartbeat-sender can send its
 heartbeats to the RPG.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>outputStream</CODE> - The open output-stream that the heartbeats shall be
            sent to. Avoid passing null as this will result in an
            error-callback to RpgTcpConnectionThread which will completely
            reestablish the socket connection.</DL>
</DD>
</DL>
<HR>

<A NAME="run()"><!-- --></A><H3>
run</H3>
<PRE>
public void <B>run</B>()</PRE>
<DL>
<DD>The run-method overriding Thread.run(). The method continuously sends out
 heartbeats by calling sendHeartbeat() and then waits for a
 Thread.interrupt(), a notify or for the wait timer to time out after a
 timer-value defined in Settings.TCP_VF_HEARTBEAT_INTERVAL.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE>run</CODE> in interface <CODE>java.lang.Runnable</CODE></DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="sendHeartbeat()"><!-- --></A><H3>
sendHeartbeat</H3>
<PRE>
public void <B>sendHeartbeat</B>()
                   throws java.io.IOException,
                          java.lang.Exception</PRE>
<DL>
<DD>Prepares the necessary Hessian payload and writes it directly to the open
 output-stream of the socket.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE>java.lang.Exception</CODE> - Thrown if there was an unknown problem writing to the
             output-stream.
<DD><CODE>java.io.IOException</CODE> - Thrown if there was a problem regarding IO while
             writing to the output-stream.</DL>
</DD>
</DL>
<HR>

<A NAME="getHeartbeatHessianPayload()"><!-- --></A><H3>
getHeartbeatHessianPayload</H3>
<PRE>
private byte[] <B>getHeartbeatHessianPayload</B>()
                                   throws java.io.IOException</PRE>
<DL>
<DD>Returns a byte-array containing the data needed for sending a heartbeat
 to the RPG.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>A byte array representing the heartbeat.
<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE> - If there was an exception serializing the hash map to
             a hessian byte array.</DL>
</DD>
</DL>
<HR>

<A NAME="getIsActive()"><!-- --></A><H3>
getIsActive</H3>
<PRE>
public boolean <B>getIsActive</B>()</PRE>
<DL>
<DD><p>
 Returns true if the heartbeat thread is currently running/active.
 </p>
 <p>
 Calling startConnection() will make this method return as the heartbeat
 thread gets started.
 </p>
 <p>
 stopConnection() will stop the connection again and make this method
 return false.
 </p>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>True if the connection is running, false otherwise.</DL>
</DD>
</DL>
<HR>

<A NAME="notifyOfWakeupAlarm()"><!-- --></A><H3>
notifyOfWakeupAlarm</H3>
<PRE>
public void <B>notifyOfWakeupAlarm</B>()</PRE>
<DL>
<DD><B>Description copied from interface: <CODE><A HREF="../../../../../../com/vodafone360/people/service/transport/IWakeupListener.html#notifyOfWakeupAlarm()">IWakeupListener</A></CODE></B></DD>
<DD>Called whenever the Service receives a Wakeup Alarm intent. The listener
 should react on this call by carrying out network activity, e.g. to keep
 the connection alive.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../../com/vodafone360/people/service/transport/IWakeupListener.html#notifyOfWakeupAlarm()">notifyOfWakeupAlarm</A></CODE> in interface <CODE><A HREF="../../../../../../com/vodafone360/people/service/transport/IWakeupListener.html" title="interface in com.vodafone360.people.service.transport">IWakeupListener</A></CODE></DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>

				<img 
				src=../../../../../../resources/logo.png 
				width=88 height=40
				>
			</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../../../com/vodafone360/people/service/transport/tcp/ConnectionTester.html" title="class in com.vodafone360.people.service.transport.tcp"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../../../com/vodafone360/people/service/transport/tcp/ResponseReaderThread.html" title="class in com.vodafone360.people.service.transport.tcp"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../../../index.html?com/vodafone360/people/service/transport/tcp/HeartbeatSenderThread.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="HeartbeatSenderThread.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>

				<p align=right>
				<font class=NavBarFont1 size=-2>
				JavaDoc<br>
				</font>
				</p>
			
</BODY>
</HTML>
